# Лабораторная работа №4: Самописный MLP на CPU

## 1. Выбранный датасет

**Датасет**: Breast Cancer Wisconsin (Diagnostic)  
**Источник**: UCI Machine Learning Repository

### Характеристики:
- **Размер**: 569 образцов
- **Признаки**: 30 числовых характеристик ядер клеток
- **Целевая переменная**: Диагноз (0 - злокачественная, 1 - доброкачественная)
- **Распределение классов**: 357 доброкачественных (62.7%), 212 злокачественных (37.3%)

## 2. Предобработка данных

### 2.1 Разделение данных
- **Обучающая выборка**: 60% (341 образец)
- **Валидационная выборка**: 20% (114 образцов)  
- **Тестовая выборка**: 20% (114 образцов)
- **Стратификация**: Сохранение пропорций классов

### 2.2 Масштабирование признаков
```python
StandardScaler()
```
- Все 30 признаков стандартизированы
- Масштабирование обучается на тренировочной выборке

## 3. Архитектура MLP

### 3.1 Структура сети
```
Входной слой: 30 нейронов
    ↓
Скрытый слой 1: 64 нейрона, ReLU
    ↓  
Скрытый слой 2: 32 нейрона, ReLU
    ↓
Выходной слой: 1 нейрон, Sigmoid
```

### 3.2 Функции активации
- **Скрытые слои**: ReLU
- **Выходной слой**: Sigmoid

## 4. Гиперпараметры

### 4.1 Параметры обучения
```python
learning_rate = 0.01
l2_lambda = 0.001
batch_size = 32
epochs = 300
```

### 4.2 Оптимальный порог классификации
- **Метод поиска**: Максимизация критерия Юдена (J = TPR - FPR)
- **Оптимальный порог**: 0.3838
- **Критерий Юдена**: 0.9627

## 5. Результаты

### 5.1 Метрики на тестовой выборке
| Метрика | Значение |
|---------|----------|
| **Accuracy** | 0.9561 |
| **F1-Score** | 0.9650 |
| **ROC-AUC** | 0.9914 |
| **Precision** | 0.9718 |
| **Recall** | 0.9583 |

### 5.2 Матрица ошибок
```
              Предсказано
             Злокачественная Доброкачественная
Злокачественная     40 (TN)       2 (FP)
Доброкачественная    3 (FN)      69 (TP)
```

## 6. Анализ обучения

### 6.1 Кривые обучения
- **Сходимость**: Модель стабилизировалась после ~100 эпох
- **Переобучение**: Минимальное (val accuracy продолжает расти)
- **Финальная точность**: Train: 99.12%, Val: 98.25%, Test: 95.61%

### 6.2 Эффективность классификации
- **ROC-AUC**: 0.9914 - отличное качество классификации
- **Чувствительность**: 95.83% (правильное определение злокачественных)
- **Специфичность**: 95.24% (правильное определение доброкачественных)

## 7. Установка и запуск

### 7.1 Требования
```bash
pip install numpy matplotlib scikit-learn pandas
```

### 7.2 Запуск
```bash
python mlp_banknote_fixed.py
```

## Выводы

1. **Высокая эффективность**: Самописный MLP достиг точности 95.61% на тестовой выборке
2. **Отличное качество классификации**: ROC-AUC = 0.9914 свидетельствует о практически идеальной разделяющей способности
3. **Стабильное обучение**: Отсутствие переобучения благодаря L2 регуляризации
4. **Практическая значимость**: Модель успешно идентифицирует злокачественные опухоли с чувствительностью 95.83%
5. **Баланс метрик**: Хороший баланс между precision (97.18%) и recall (95.83%)

Разработанный самописный MLP демонстрирует, что даже простая нейронная сеть, реализованная с нуля, может достигать выдающихся результатов в задачах медицинской диагностики, сравнимых с современными подходами.

---
